<!-- fundi-dash.component.html -->

<!-- Hidden menu trigger for AppBar action button -->
<button 
  #accountMenuTrigger="matMenuTrigger"
  [matMenuTriggerFor]="accountMenu"
  style="display: none;">
</button>

<!-- Account Menu -->
<mat-menu #accountMenu="matMenu">
  <button mat-menu-item (click)="goToProfile()">
    <mat-icon>person</mat-icon>
    <span>Profile</span>
  </button>
  <button mat-menu-item (click)="goToSettings()">
    <mat-icon>settings</mat-icon>
    <span>Settings</span>
  </button>
  <mat-divider></mat-divider>
  <button mat-menu-item (click)="logout()">
    <mat-icon>logout</mat-icon>
    <span>Logout</span>
  </button>
</mat-menu>

<div class="page">
  
  @if (isMobile()) { 
    <br><br>
    
    <!-- Welcome Card -->
    <section class="card welcome-card">
      <div class="welcome-content">
        <img 
          [src]="imgFile ? imgUrl + imgFile : 'assets/user.png'" 
          alt="Profile" 
          class="profile-avatar"
        />
        <div class="welcome-text">
          <h2>Welcome, {{ username }}!</h2>
          <p>Keep building. Log your gigs to grow your profile.</p>
        </div>
      </div>
    </section>

    <!-- Credit Score Card -->
    <section class="card credit-card">
      <h3>Credit Score</h3>
      <div class="score-wrapper">
        <div class="score-circle" [style.background]="getScoreGradient()">
          <span>{{ creditScore }}</span>
        </div>
      </div>
      <p class="score-label">{{ creditScore >= 70 ? 'Reliable User' : 'Keep building your profile' }}</p>
    </section>

    <!-- Quick Actions Grid -->
    <section class="mobile-nav">
      <!-- Log Gig -->
      <div class="nav-card" routerLink="/main-menu/log-gig">
        <i class="material-icons">add</i>
        <span>Log Gig</span>
      </div>

      <!-- M-Pesa -->
      <div class="nav-card" routerLink="/main-menu/mpesa">
        <i class="material-icons">payment</i>
        <span>M-PESA</span>
      </div>

      <!-- Proof of Payment -->
      <div class="nav-card" routerLink="/main-menu/proof-of-payments">
        <i class="material-icons">upload_file</i>
        <span>Proof of Payment</span>
      </div>

      <!-- Search Gigs -->
      <div class="nav-card" routerLink="/main-menu/search-gig">
        <i class="material-icons">search</i>
        <span>Search Gigs</span>
      </div>

      <!-- Credit Score -->
      <div class="nav-card" routerLink="/main-menu/credit-score">
        <i class="material-icons">score</i>
        <span>Credit Score</span>
      </div>

      <!-- Work History -->
      <div class="nav-card" routerLink="/main-menu/work-history">
        <i class="material-icons">history</i>
        <span>Work History</span>
      </div>
    </section>

    <!-- Gigs Summary Card -->
    <section class="card list-card" routerLink="/main-menu/gig-list">
      <div class="list-item">
        <i class="material-icons green">work_outline</i>
        <div>
          <h4>Gig Summary</h4>
          <p>{{ verifiedGigs }} Verified / {{ totalGigs }} Total</p>
        </div>
        <i class="material-icons">chevron_right</i>
      </div>
    </section>

    <!-- Profile Summary Card -->
    <section class="card profile-card">
      <h3>Profile Information</h3>
      <div class="profile-info">
        <div class="info-row">
          <i class="material-icons">person</i>
          <span>{{ fullname }}</span>
        </div>
        <div class="info-row">
          <i class="material-icons">email</i>
          <span>{{ email }}</span>
        </div>
        <div class="info-row">
          <i class="material-icons">location_on</i>
          <span>{{ location }}</span>
        </div>
      </div>
    </section>

    <!-- Location Reminder Card -->
    <section class="card location-card">
      <div class="list-item">
        <i class="material-icons red">gps_fixed</i>
        <div>
          <h4>Location Access</h4>
          <p>Allow location to verify gigs automatically.</p>
        </div>
        <mat-slide-toggle [checked]="true"></mat-slide-toggle>
      </div>
    </section>
  }

  <!-- ðŸ”¥ DESKTOP DASHBOARD - Kept your original desktop code -->
  @if (!isMobile()) {
    <!-- Desktop Header -->
    <div class="desktop-header">
      <h1>Dashboard</h1>
      <p>Welcome back! Here's your business overview</p>
    </div>

    <!-- Stats Grid -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-header">
          <div class="stat-icon bg-blue">
            <i class="material-icons">work_outline</i>
          </div>
          <span class="stat-change">+12%</span>
        </div>
        <h3>Total Jobs</h3>
        <p class="stat-value">47</p>
      </div>

      <div class="stat-card">
        <div class="stat-header">
          <div class="stat-icon bg-green">
            <i class="material-icons">people_outline</i>
          </div>
          <span class="stat-change">+8%</span>
        </div>
        <h3>Active Clients</h3>
        <p class="stat-value">23</p>
      </div>

      <div class="stat-card">
        <div class="stat-header">
          <div class="stat-icon bg-purple">
            <i class="material-icons">attach_money</i>
          </div>
          <span class="stat-change">+15%</span>
        </div>
        <h3>Revenue</h3>
        <p class="stat-value">KSh 340K</p>
      </div>

      <div class="stat-card">
        <div class="stat-header">
          <div class="stat-icon bg-orange">
            <i class="material-icons">calendar_today</i>
          </div>
          <span class="stat-change">+5%</span>
        </div>
        <h3>This Month</h3>
        <p class="stat-value">12 Jobs</p>
      </div>
    </div>

    <!-- Desktop Content Grid -->
    <div class="desktop-grid">
      <!-- Recent Jobs -->
      <div class="desktop-card recent-jobs">
        <div class="card-header">
          <h2>Recent Jobs</h2>
        </div>
        <div class="jobs-list">
          <div class="job-item">
            <div class="job-main">
              <div class="job-info">
                <h3>John Mwangi</h3>
                <p>Plumbing Repair</p>
              </div>
              <span class="job-amount">KSh 8,500</span>
            </div>
            <div class="job-footer">
              <span class="status-badge completed">
                <i class="material-icons">check_circle</i>
                completed
              </span>
              <span class="job-time">2 hours ago</span>
            </div>
          </div>

          <div class="job-item">
            <div class="job-main">
              <div class="job-info">
                <h3>Jane Wanjiku</h3>
                <p>Electrical Installation</p>
              </div>
              <span class="job-amount">KSh 15,000</span>
            </div>
            <div class="job-footer">
              <span class="status-badge in-progress">
                <i class="material-icons">schedule</i>
                in progress
              </span>
              <span class="job-time">5 hours ago</span>
            </div>
          </div>

          <div class="job-item">
            <div class="job-main">
              <div class="job-info">
                <h3>Peter Kamau</h3>
                <p>Carpentry Work</p>
              </div>
              <span class="job-amount">KSh 12,000</span>
            </div>
            <div class="job-footer">
              <span class="status-badge pending">
                <i class="material-icons">error_outline</i>
                pending
              </span>
              <span class="job-time">1 day ago</span>
            </div>
          </div>

          <div class="job-item">
            <div class="job-main">
              <div class="job-info">
                <h3>Mary Akinyi</h3>
                <p>House Painting</p>
              </div>
              <span class="job-amount">KSh 25,000</span>
            </div>
            <div class="job-footer">
              <span class="status-badge completed">
                <i class="material-icons">check_circle</i>
                completed
              </span>
              <span class="job-time">2 days ago</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Upcoming Appointments -->
      <div class="desktop-card upcoming">
        <div class="card-header">
          <h2>Upcoming</h2>
        </div>
        <div class="appointments-list">
          <div class="appointment-item">
            <div class="appointment-icon">
              <i class="material-icons">calendar_today</i>
            </div>
            <div class="appointment-info">
              <h3>David Omondi</h3>
              <p>Plumbing Inspection</p>
              <span class="appointment-time">Today, 2:00 PM</span>
            </div>
          </div>

          <div class="appointment-item">
            <div class="appointment-icon">
              <i class="material-icons">calendar_today</i>
            </div>
            <div class="appointment-info">
              <h3>Sarah Njeri</h3>
              <p>Electrical Repair</p>
              <span class="appointment-time">Tomorrow, 10:00 AM</span>
            </div>
          </div>

          <div class="appointment-item">
            <div class="appointment-icon">
              <i class="material-icons">calendar_today</i>
            </div>
            <div class="appointment-info">
              <h3>James Kimani</h3>
              <p>Cabinet Installation</p>
              <span class="appointment-time">Dec 23, 3:00 PM</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  }

  <!-- CREDIT SCORE - Visible on both mobile and desktop (your original code) -->
  <section class="card credit-card">
    <h3>Credit Score</h3>
    <div class="score-wrapper">
      <div class="score-circle">
        <span>75</span>
      </div>
    </div>
    <p class="score-label">Reliable User</p>
  </section>

  <!-- GIG SUMMARY (your original code) -->
  <section class="card list-card" routerLink="/main-menu/gig-summary">
    <div class="list-item">
      <i class="material-icons green">work_outline</i>
      <div>
        <h4>Gig Summary</h4>
        <p>3 Verified / 8 Total</p>
      </div>
      <i class="material-icons">chevron_right</i>
    </div>
  </section>
</div>